define(["avalon","json/avalon.json"],function(e){var t={disabled:!1,set:function(e,t){},get:function(e){},remove:function(e){},clear:function(){},forEach:function(e){},getAll:function(){var e={};return t.forEach(function(t,n){e[t]=n}),e},serialize:function(e){return JSON.stringify(e)},parse:function(e){if(typeof e!="string")return void 0;try{return JSON.parse(e)}catch(t){return e||undefined}}},n="test"+(new Date-0),r="localStorage",i,s=!1;try{localStorage.setItem(n,"mass"),localStorage.removeItem(n),s=!0}catch(o){}if(s)i=localStorage,e.mix(t,{set:function(e,n){return n===void 0?t.remove(e):(i.setItem(e,t.serialize(n)),n)},get:function(e){return t.parse(i.getItem(e))},remove:function(e){i.removeItem(e)},clear:function(){i.clear()},forEach:function(e){for(var n=0;n<i.length;n++){var r=i.key(n);e(r,t.get(r))}}});else if(document.documentElement.addBehavior){var u,a;try{var f="script";a=new ActiveXObject("htmlfile"),a.open(),a.write("<"+f+">document.w=window</"+f+'><iframe src="/favicon.ico"></iframe>'),a.close(),u=a.w.frames[0].document,i=u.createElement("div")}catch(o){i=document.createElement("div"),u=document.body}function l(e){return function(){var n=Array.prototype.slice.call(arguments,0);n.unshift(i),u.appendChild(i),i.addBehavior("#default#userData"),i.load(r);var s=e.apply(t,n);try{u.removeChild(i)}catch(o){}return s}}var c=new RegExp("[!\"#$%&'()*+,/\\\\:;<=>?@[\\]^`{|}~]","g");function h(e){return e.replace(/^d/,"___$&").replace(c,"___")}e.mix(t,{set:l(function(e,n,i){return n=h(n),i===void 0?t.remove(n):(e.setAttribute(n,t.serialize(i)),e.save(r),i)}),get:l(function(e,n){return n=h(n),t.parse(e.getAttribute(n))}),remove:l(function(e,t){t=h(t),e.removeAttribute(t),e.save(r)}),clear:function(){t.forEach(function(e){t.remove(e)})},forEach:l(function(e,n){var r=e.XMLDocument.documentElement.attributes;for(var i=0,s;s=r[i];++i)n(s.name,t.parse(e.getAttribute(s.name)))})})}try{t.set(r,r),t.get(r)!=r&&(t.disabled=!0),t.remove(r)}catch(o){t.disabled=!0}return e.store=t,e});