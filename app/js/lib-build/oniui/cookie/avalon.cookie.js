define(["avalon"],function(){function e(e){e.indexOf('"')===0&&(e=e.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return decodeURIComponent(e.replace(/\+/g," "))}catch(t){return e}}var t={stringify:function(e,t,n){var r=[e+"="+encodeURIComponent(t)];return isFinite(n)&&typeof n=="number"?r.push("Max-Age="+n):(n=n||{},n.maxAge&&r.push("Max-Age="+n.maxAge),n.domain&&r.push("Domain="+n.domain),n.path&&r.push("Path="+n.path),n.expires&&r.push("Expires="+n.expires.toUTCString()),n.httpOnly&&r.push("HttpOnly"),n.secure&&r.push("Secure")),r.join("; ")},forEach:function(t){var n=String(document.cookie).split(/; */);n.forEach(function(n){var r=n.indexOf("=");if(r===-1)return;var i=n.substr(0,r).trim(),s=n.substr(++r,n.length).trim();t(i,e(s))})},get:function(e){var n;try{t.forEach(function(t,r){if(t===e)throw n=r,""})}catch(r){}return n},getAll:function(){var e={};return t.forEach(function(t,n){t in e||(e[t]=n)}),e},set:function(e,n,r){document.cookie=t.stringify.apply(0,arguments)},remove:function(e,n){n=n||{},n.expires||(n.expires=new Date(1970,0,1)),t.set(e,"",n)},clear:function(){t.forEach(function(e,n){t.remove(e)})}};return avalon.cookie=t,avalon});