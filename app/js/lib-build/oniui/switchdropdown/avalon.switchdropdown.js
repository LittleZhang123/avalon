define(["avalon","text!./avalon.switchdropdown.html","../dropdown/avalon.dropdown","../avalon.getModel","css!./avalon.switchdropdown.css"],function(e,t){function i(t,n,r){var i=n||[],s=t.children;r=r||null;for(var u=0,a;a=s[u++];)if(a.nodeType===1&&a.tagName==="OPTION"){var f={label:" "+a.text.trim(),title:a.title.trim(),value:o(e(a).val()),enable:!a.disabled,group:!1,selected:a.selected,parent:r};e(a).attr("data-title-value")&&(f.titleValue=" "+e(a).attr("data-title-value").trim()),i.push(f);if(i.length===2)break}return i}function s(t){return e.each(t,function(e,t){t.text=t.label,t.label=['<i class="oni-icon ',t.iconClass,'">',t.font,"</i>",t.label].join(""),t.titleValue=['<i class="oni-icon ',t.iconClass,'">',t.font,"</i>",t.titleValue].join("")}),t}function o(e){try{e=e==="true"?!0:e==="false"?!1:e==="null"?null:+e+""===e?+e:e}catch(t){}return e}var n=[{value:1,label:" 启用",iconClass:"g-icon-start",title:"启用",font:"&#xf111;",titleValue:" 已启用"},{value:2,label:" 暂停",iconClass:"g-icon-pause",title:"暂停",font:"&#xf04c;",titleValue:" 已暂停"}],r=e.ui.switchdropdown=function(t,r,o){var u=r.switchdropdownOptions;u.data=s(e.mix(!0,[],n,i(t),u.data));for(var a=u.value,f=u.data[0].value,l=0,c=u.data.length,h;l<c;l++){h=u.data[l];if(h.value===a){f=a;break}h.selected&&(f=h.value)}u.value=f;var p=e.define("switchdropdown"+setTimeout("1"),function(n){n.$opts=u,n.$init=function(n){n?n():(e.log("请尽快升到avalon1.3.7+"),e.scan(t,[p].concat(o)),typeof u.onInit=="function"&&u.onInit.call(t,p,u,o))}});return e(t).attr("ms-widget",["dropdown",r.switchdropdownId,"$opts"].join()),t.innerHTML="",p};r.version="1.0",r.defaults={width:100,listWidth:100,height:60,enable:!0,readOnly:!1,data:[],value:"",getTemplate:function(){return t},onInit:e.noop}});