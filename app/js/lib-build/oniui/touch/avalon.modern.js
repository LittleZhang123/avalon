/*==================================================
 Copyright (c) 2013-2014 司徒正美 and other contributors
 http://www.cnblogs.com/rubylouvre/
 https://github.com/RubyLouvre
 http://weibo.com/jslouvre/
 
 Released under the MIT license
 avalon 1.3.7.2 2014.11.19 support IE10 and other latest browsers
 ==================================================*/

(function(e){function x(){}function T(){avalon.config.debug&&console.log.apply(console,arguments)}function N(e,t){typeof e=="string"&&(e=e.match(u)||[]);var n={},r=t!==void 0?t:1;for(var i=0,s=e.length;i<s;i++)n[e[i]]=r;return n}function C(){return"avalon"+Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)}function k(e){return typeof e=="function"}function L(e){if(e&&typeof e=="object"){var t=e.length,n=d.call(e);if(/(Array|List|Collection|Map|Arguments)\]$/.test(n))return!0;if(n==="[object Object]"&&+t===t&&!(t%1)&&t>=0)return!0}return!1}function P(e,t,n){if(k(t)||t&&t.nodeType)return!1;if(n.indexOf(e)!==-1)return!1;if(D.indexOf(e)!==-1)return!1;var r=n.$special;return e&&e.charAt(0)==="$"&&!r[e]?!1:!0}function H(e,r,i){if(Array.isArray(e)){var s=e.concat();e.length=0;var u=jn(e);return u.pushArray(s),u}if(typeof e.nodeType=="number")return e;if(e.$id&&e.$model&&e.$events)return e;Array.isArray(e.$skipArray)||(e.$skipArray=[]),e.$skipArray.$special=r||{};var a={};i=i||{};var l={},c={},h=[];for(var p in e)(function(r,s){i[r]=s;if(!P(r,s,e.$skipArray))return;var u,p=avalon.type(s);l[r]=[];if(p==="object"&&k(s.get)&&Object.keys(s).length<=2){var d=s.set,v=s.get;u=function(e){var t=a.$events,n=i[r];if(arguments.length){if(o)return;if(k(d)){var s=t[r];t[r]=[],d.call(a,e),t[r]=s}}else avalon.openComputedCollect&&St(t[r]);return e=i[r]=v.call(a),B(n,e)||(q&&U(a.$id,r,e),Ot(t[r]),j(a,r,e,n)),e},h.push(function(){g[t]={evaluator:u,element:y,type:"computed::"+r,handler:x,args:[]},u(),St(l[r]),delete g[t]})}else if(f.test(p)){u=function(e){var t=u.child,n=i[r];if(!arguments.length)return St(l[r]),t;if(o)return;if(!B(n,e)){t=u.child=z(a,r,e,p),e=i[r]=t.$model;var s=R[t.$id];s&&s(),j(a,r,e,n)}};var m=u.child=H(s,0,i[r]);m.$events[n]=l[r]}else u=function(e){var t=i[r];if(!arguments.length)return St(l[r]),t;B(t,e)||(i[r]=e,q&&U(a.$id,r,e),Ot(l[r]),j(a,r,e,t))};c[r]=u})(p,e[p]);D.forEach(function(t){delete e[t],delete i[t]}),Object.defineProperties(a,F(c));for(var d in e)c[d]||(a[d]=e[d]);a.$id=C(),a.$model=i,a.$events=l;for(var p in yt){var v=yt[p];a[p]=v}return Object.defineProperty(a,"hasOwnProperty",{value:function(e){return e in a.$model},writable:!1,enumerable:!1,configurable:!0}),h.forEach(function(e){e()}),a}function j(e,t,n,r){e.$events&&yt.$fire.call(e,t,n,r)}function F(e){var t={};for(var n in e)t[n]={get:e[n],set:e[n],enumerable:!0,configurable:!0};return t}function U(e,t,n){var r=I[e];r&&r[t]&&(r[t].$val=n)}function z(e,t,r,i){var s=e[t];if(i==="array")return!Array.isArray(r)||s===r?s:(s.clear(),s.pushArray(r.concat()),s);var o=e.$events[t];I[s.$id]&&(q--,delete I[s.$id]);var u=H(r);return u.$events[n]=o,R[u.$id]=function(e){while(e=o.shift())(function(e){e.type&&avalon.nextTick(function(){e.rollback&&e.rollback(),Sn[e.type](e,e.vmodels)})})(e);delete R[u.$id]},u}function W(e){for(var t in e){if(!p.call(e,t))continue;var n=e[t];typeof W.plugins[t]=="function"?W.plugins[t](n):typeof W[t]=="object"?avalon.mix(W[t],n):W[t]=n}return this}function G(e){return(e+"").replace(Q,"\\$&")}function et(e){return e.replace(/([a-z\d])([A-Z]+)/g,"$1-$2").toLowerCase()}function tt(e){return e.indexOf("-")<0&&e.indexOf("_")<0?e:e.replace(/[-_][^-_]/g,function(e){return e.charAt(1).toUpperCase()})}function rt(e){try{e=e==="true"?!0:e==="false"?!1:e==="null"?null:+e+""===e?+e:nt.test(e)?JSON.parse(e):e}catch(t){}return e}function it(e){return e.window&&e.document?e:e.nodeType===9?e.defaultView:!1}function lt(e,t){if(e.offsetWidth<=0){var n=getComputedStyle(e,null);if(ft.test(n.display)){var r={node:e};for(var i in at)r[i]=n[i],e.style[i]=at[i];t.push(r)}var s=e.parentNode;s&&s.nodeType===1&&lt(s,t)}}function ct(e){var t=e.tagName.toLowerCase();return t==="input"&&/checkbox|radio/.test(e.type)?"checked":t}function bt(t){return e.querySelector(t)}function Et(n){g[t]=n,avalon.openComputedCollect=!0;var r=n.evaluator;if(r)try{var i=wt.test(n.type)?n:r.apply(0,n.args);n.handler(i,n.element,n)}catch(s){T("warning:exception throwed in [registerSubscriber] "+s),delete n.evaluator;var o=n.element;if(o.nodeType===3){var u=o.parentNode;W.commentInterpolate?u.replaceChild(e.createComment(n.value),o):o.data=X+n.value+V}}avalon.openComputedCollect=!1,delete g[t]}function St(e){var n=g[t];e&&n&&avalon.Array.ensure(e,n)&&n.element&&xt(n,e)}function xt(e,t){e.$uuid=e.$uuid||C(),t.$uuid=t.$uuid||C();var n={data:e,list:t,toString:function(){return e.$uuid+" "+t.$uuid}};Tt[n]||(Tt[n]=1,Tt.push(n))}function At(){for(var e=Nt,t=Nt+Ct;e<t;e++){var n=Tt[e];if(!n)break;var r=n.data,i=r.element,s=i===null?1:!avalon.contains(b,i);if(s){Tt.splice(e,1),delete Tt[n],avalon.Array.remove(n.list,r),r.type==="if"&&r.template&&r.template.parentNode===dn&&dn.removeChild(r.template);for(var o in r)r[o]=null;n.data=n.list=null,e--,t--}}n=Tt[e],n?Nt=t:Nt=0,kt=Date.now()}function Ot(e){clearTimeout(Lt),Date.now()-kt>444?At():Lt=setTimeout(At,444);if(e&&e.length){var t=m.call(arguments,1);for(var n=e.length,r;r=e[--n];){var i=r.element;if(i&&i.parentNode)if(r.$repeat)r.handler.apply(r,t);else if(r.type!=="on"){var s=r.evaluator||x;r.handler(s.apply(0,r.args||[]),i,r)}}}}function Dt(e,t,n){var r=setTimeout(function(){var i=e.innerHTML;clearTimeout(r),i===n?t():Dt(e,t,i)})}function Pt(e,t,n){var r=e.getAttribute("ms-skip"),i=e.getAttributeNode("ms-important"),s=e.getAttributeNode("ms-controller");if(typeof r=="string")return;if(n=i||s){var o=_[n.value];if(!o)return;var u=t.cb;t=n===i?[o]:[o].concat(t),t.cb=u,e.removeAttribute(n.name),e.classList.remove(n.name),Ht(e,o),e.setAttribute("avalonctrl",n.value),o.$events.expr=e.tagName+'[avalonctrl="'+n.value+'"]'}Wt(e,t)}function Ht(e,t){var n=e.getAttribute("avalonctrl")||t.$id;e.setAttribute("avalonctrl",n),t.$events.expr=e.tagName+'[avalonctrl="'+n+'"]'}function Bt(e,t){var n=e.firstChild;while(n){var r=n.nextSibling;Ft(n,n.nodeType,t),n=r}}function jt(e,t){for(var n=0,r;r=e[n++];)Ft(r,r.nodeType,t)}function Ft(e,t,n){t===1?Pt(e,n):t===3&&$.test(e.data)?It(e,n):W.commentInterpolate&&t===8&&!$.test(e.nodeValue)&&It(e,n)}function It(t,n){var r=[];if(t.nodeType===8){var i=[],s=Kt(t.nodeValue,i),o={expr:!0,value:s};i.length&&(o.filters=i);var u=[o]}else u=Qt(t.data);if(u.length){for(var a=0,o;o=u[a++];){var f=e.createTextNode(o.value);if(o.expr){var l=o.filters,c={type:"text",element:f,value:o.value,filters:l};l&&l.indexOf("html")!==-1&&(avalon.Array.remove(l,"html"),c.type="html",c.group=1,l.length||delete r.filters),r.push(c)}w.appendChild(f)}t.parentNode.replaceChild(w,t),r.length&&Xt(r,n)}}function Wt(e,t){var n=e.hasAttributes()?avalon.slice(e.attributes):[],r=[],i={},s;for(var o=0,u;u=n[o++];)if(u.specified)if(s=u.name.match(qt)){var a=s[1],f=s[2]||"",l=u.value,c=u.name;i[c]=l,Ut[a]?(f=a,a="on"):zt[a]&&(T("ms-"+a+"已经被废弃,请使用ms-attr-*代替"),a==="enabled"&&(a="disabled",l="!("+l+")"),f=a,a="attr",e.removeAttribute(c),c="ms-attr-"+f,e.setAttribute(c,l),s=[c],i[c]=l);if(typeof Sn[a]=="function"){var h={type:a,param:f,element:e,name:s[0],value:l,priority:a in Rt?Rt[a]:a.charCodeAt(0)*10+(Number(f)||0)};a==="if"&&f==="loop"&&(h.priority+=100),t.length&&(r.push(h),a==="widget"&&(e.msData=e.msData||i))}}i["ms-checked"]&&i["ms-duplex"]&&T("warning!一个元素上不能同时定义ms-checked与ms-duplex"),r.sort(function(e,t){return e.priority-t.priority});var p=r[0]||{};switch(p.type){case"if":case"repeat":case"widget":Xt([p],t);break;default:Xt(r,t),!_t[e.tagName]&&K.test(e.innerHTML+e.textContent)&&Bt(e,t)}}function Xt(e,t){e.length&&t.cb(e.length);for(var n=0,r;r=e[n++];)r.vmodels=t,Sn[r.type](r,t),r.evaluator&&r.element&&r.element.nodeType===1&&r.element.removeAttribute(r.name);e.length=0}function Kt(e,t){return e.indexOf("|")>0&&(e=e.replace($t,"U2hvcnRDaXJjdWl0"),e=e.replace(Vt,function(e,n,r){return t.push(n+(r||"")),""}),e=e.replace(Jt,"||")),e}function Qt(e){var t=[],n,r=0,i;do{i=e.indexOf(X,r);if(i===-1)break;n=e.slice(r,i),n&&t.push({value:n,expr:!1}),r=i+X.length,i=e.indexOf(V,r);if(i===-1)break;n=e.slice(r,i);if(n){var s=[];n=Kt(n,s),t.push({value:n,expr:!0,filters:s.length?s:void 0})}r=i+V.length}while(1);return n=e.slice(r),n&&t.push({value:n,expr:!1}),t}function on(e,t,n,r){var i=[],s=" = "+n+".";for(var o=e.length,u;u=e[--o];)t.hasOwnProperty(u)&&(i.push(u+s+u),r.vars.push(u),r.type==="duplex"&&(e.get=n+"."+u),e.splice(o,1));return i}function un(e){var t=[],n={};for(var r=0;r<e.length;r++){var i=e[r],s=i&&typeof i.$id=="string"?i.$id:i;n[s]||(n[s]=t.push(i))}return t}function an(e){function n(r,i){return t.push(r)>e&&delete n[t.shift()],n[r]=i}var t=[];return n}function hn(e,n,r){var i=r.type,s=i==="duplex",o=r.filters?r.filters.join(""):"",u=n.map(function(e){return e.$id.replace(cn,"$1")})+e+i+o,a=sn(e).concat(),f=[],l=[],c=[],h="";r.vars=[],n=un(n);for(var p=0,d=n.length;p<d;p++)if(a.length){var v="vm"+t+"_"+p;l.push(v),c.push(n[p]),f.push.apply(f,on(a,n[p],v,r))}if(!f.length&&s)return;s||r.vars.forEach(function(t){var n=new RegExp("\\b"+t+"(?:\\.\\w+|\\[\\w+\\])+","ig");e=e.replace(n,function(e){var n=e.charAt(t.length);if(n==="."||n==="["){var r="var"+String(Math.random()).replace(/^0\./,"");return f.push(r+" = "+e),r}return e})}),o&&c.push(avalon.filters),r.args=c;var m=fn[u];if(m){r.evaluator=m;return}var h=f.join(", ");h&&(h="var "+h);if(o){e="\nvar ret"+t+" = "+e;var g=[],y;g.push(e,"\r\n");for(var p=0,b;b=r.filters[p++];){var w=b.indexOf("(");w!==-1?(y=b.slice(w+1,b.lastIndexOf(")")).trim(),y=","+y,b=b.slice(0,w).trim()):y="",g.push(" if(filters",t,".",b,"){\n	try{\nret",t," = filters",t,".",b,"(ret",t,y,")\n	}catch(e){} \n}\n")}e=g.join(""),e+="\nreturn ret"+t,l.push("filters"+t)}else{if(s){var E="'use strict';\nreturn function(vvv){\n	"+h+";\n	if(!arguments.length){\n		return "+e+"\n	}\n	"+(ln.test(e)?e:a.get)+"= vvv;\n} ";try{m=Function.apply(x,l.concat(E)),r.evaluator=fn(u,m)}catch(S){T("debug: parse error,"+S.message)}return}if(i==="on"){e.indexOf("(")===-1?e+=".call(this, $event)":e=e.replace("(",".call(this,"),l.push("$event"),e="\nreturn "+e+";";var N=e.lastIndexOf("\nreturn"),C=e.slice(0,N),k=e.slice(N);e=C+"\n"+k}else e="\nreturn "+e+";"}try{m=Function.apply(x,l.concat("'use strict';\n"+h+e)),r.evaluator=fn(u,m)}catch(S){T("debug: parse error,"+S.message)}finally{a=g=l=null}}function pn(e,t,n,r,i){t.cb(-1),Array.isArray(r)&&(e=r.map(function(e){return e.expr?"("+e.value+")":JSON.stringify(e.value)}).join(" + ")),hn(e,t,n),n.evaluator&&!i&&(n.handler=bn[n.handlerName||n.type],Et(n))}function En(t,n){var r="_"+t;if(!En[r]){var i=e.createElement(t);b.appendChild(i),n=getComputedStyle(i,null).display,b.removeChild(i),En[r]=n}return En[r]}function Tn(e){return e==null?"":e}function Nn(e,t,n){return t.param.replace(/\w+/g,function(r){var i=avalon.duplexHooks[r];i&&typeof i[n]=="function"&&(e=i[n](e,t))}),e}function An(t,n,r){var i=e.createEvent("Events");i.initEvent(n,!0,!0),r&&(i.detail=r),t.dispatchEvent(i)}function On(e){var t=arguments.length?e:this.value;if(!this.disabled&&this.oldValue!==t){var n=this.getAttribute("data-duplex-event")||"input";n=n.match(u).shift(),An(this,n)}}function Mn(){for(var e=kn.length-1;e>=0;e--){var t=kn[e];t()===!1&&kn.splice(e,1)}kn.length||clearInterval(Cn)}function _n(e){Pn.call(this,e),On.call(this,e)}function jn(e){var t=[];t.$id=C(),t.$model=e,t.$events={},t.$events[n]=[],t._=H({length:e.length}),t._.$watch("length",function(e,n){t.$fire("length",e,n)});for(var r in yt)t[r]=yt[r];return avalon.mix(t,In),t}function qn(e,t){var n=avalon.type(e);return f.test(n)&&(e=e.$id?e:H(e,0,t)),e}function Rn(e,t,n,r){var i=avalon.parseHTML(e.template),s=avalon.slice(i.childNodes);t.appendChild(i),n.$outer=e.$outer;var o=e.vmodels,u=[n].concat(o);u.cb=o.cb;var a={nodes:s,vmodels:u};r.push(a)}function Un(e,t){var n=e.element,r=e.endRepeat,i=[],s=n.nextSibling;if(s!==r)do{if(s===r)break;i.push(s)}while(s=s.nextSibling);return i[e.group*t]||r}function zn(e,t,n){var r=t*(n||1),i=[e],s=1,o=w;while(s<r)e=e.nextSibling,e&&(i[s++]=e);for(var s=0;e=i[s++];)o.appendChild(e);return o}function Wn(e){if(!isFinite(e.group)){var t=e.element.parentNode.childNodes,n=t.length-2,r="proxySize"in e?e.proxySize:e.proxies.length;e.group=n/r}}function Vn(e,t,n){var r=H({$key:e,$outer:n,$val:t},{$val:1,$key:1});return r.$id=("$proxy$with"+Math.random()).replace(/0\./,""),r}function Jn(e,t,n,r){var i=n.param||"el",s,o={$remove:function(){return n.$repeat.removeAt(s.$index)},$itemName:i,$index:e,$outer:n.$outer,$first:e===0,$last:e===r};o[i]=t;for(var u=0,a=$n.length;u<a;u++){var s=$n[u];if(s.hasOwnProperty(i)&&avalon.type(s[i])===avalon.type(t)){for(var f in o)s[f]=o[f];return $n.splice(u,1),s.$watch(i,function(e){n.$repeat.set(s.$index,e)}),s}}var l=avalon.type(t);if(l==="object"||l==="function")o.$skipArray=[i];return s=H(o,Xn),s.$watch(i,function(e){n.$repeat.set(s.$index,e)}),s.$id=("$proxy$"+n.type+Math.random()).replace(/0\./,""),s}function Kn(e){for(var t=0,n;n=e[t++];)Qn(n);e.length=0}function Qn(e){for(var t in e.$events)Array.isArray(e.$events[t])&&(e.$events[t].length=0);$n.unshift(e)>W.maxRepeatSize&&$n.pop()}function or(){Y?(ir["ready!"].state=2,Y.checkDeps()):sr.forEach(function(e){e(avalon)}),or=x}var t=Date.now(),n="$"+t,r=Function("return this")(),i=r.require,s=r.define,o=!1,u=/[^, ]+/g,f=/^(?:object|array)$/,l=/^\[object SVG\w*Element\]$/,c=/^\[object (Window|DOMWindow|global)\]$/,h=Object.prototype,p=h.hasOwnProperty,d=h.toString,v=Array.prototype,m=v.slice,g={},y=e.head,b=e.documentElement,w=e.createDocumentFragment(),E=e.createElement("div"),S={};"Boolean Number String Function Array Date RegExp Object Error".replace(u,function(e){S["[object "+e+"]"]=e.toLowerCase()}),r.avalon=function(e){return new avalon.init(e)},avalon.init=function(e){this[0]=this.element=e},avalon.fn=avalon.prototype=avalon.init.prototype,avalon.isFunction=k,avalon.type=function(e){return e==null?String(e):typeof e=="object"||typeof e=="function"?S[d.call(e)]||"object":typeof e},avalon.isWindow=function(e){return c.test(d.call(e))},avalon.isPlainObject=function(e){return!!e&&typeof e=="object"&&Object.getPrototypeOf(e)===h},avalon.mix=avalon.fn.mix=function(){var e,t,n,r,i,s,o=arguments[0]||{},u=1,a=arguments.length,f=!1;typeof o=="boolean"&&(f=o,o=arguments[1]||{},u++),typeof o!="object"&&avalon.type(o)!=="function"&&(o={}),u===a&&(o=this,u--);for(;u<a;u++)if((e=arguments[u])!=null)for(t in e){n=o[t],r=e[t];if(o===r)continue;f&&r&&(avalon.isPlainObject(r)||(i=Array.isArray(r)))?(i?(i=!1,s=n&&Array.isArray(n)?n:[]):s=n&&avalon.isPlainObject(n)?n:{},o[t]=avalon.mix(f,s,r)):r!==void 0&&(o[t]=r)}return o},avalon.mix({rword:u,subscribers:n,version:1.36,ui:{},log:T,noop:x,error:function(e,t){throw new(t||Error)(e)},oneObject:N,range:function(e,t,n){n||(n=1),t==null&&(t=e||0,e=0);var r=-1,i=Math.max(0,Math.ceil((t-e)/n)),s=Array(i);while(++r<i)s[r]=e,e+=n;return s},slice:function(e,t,n){return m.call(e,t,n)},eventHooks:{},bind:function(e,t,n,r){var i=avalon.eventHooks,s=i[t];return typeof s=="object"&&(t=s.type,s.deel&&(n=s.deel(e,n))),e.addEventListener(t,n,!!r),n},unbind:function(e,t,n,r){var i=avalon.eventHooks,s=i[t];typeof s=="object"&&(t=s.type),e.removeEventListener(t,n||x,!!r)},css:function(e,t,n){e instanceof avalon&&(e=e[0]);var r=/[_-]/.test(t)?tt(t):t;t=avalon.cssName(r)||r;if(n===void 0||typeof n=="boolean"){var i=st[r+":get"]||st["@:get"];t==="background"&&(t="backgroundColor");var s=i(e,t);return n===!0?parseFloat(s)||0:s}if(n==="")e.style[t]="";else{if(n==null||n!==n)return;isFinite(n)&&!avalon.cssNumber[r]&&(n+="px"),i=st[r+":set"]||st["@:set"],i(e,t,n)}},each:function(e,t){if(e){var n=0;if(L(e))for(var r=e.length;n<r;n++)t(n,e[n]);else for(n in e)e.hasOwnProperty(n)&&t(n,e[n])}},getWidgetData:function(e,t){var n=avalon(e).data(),r={};for(var i in n)i.indexOf(t)===0&&(r[i.replace(t,"").replace(/\w/,function(e){return e.toLowerCase()})]=n[i]);return r},parseJSON:JSON.parse,Array:{ensure:function(e,t){if(e.indexOf(t)===-1)return e.push(t)},removeAt:function(e,t){return!!e.splice(t,1).length},remove:function(e,t){var n=e.indexOf(t);return~n?avalon.Array.removeAt(e,n):!1}}}),avalon.nextTick=r.setImmediate?setImmediate.bind(r):function(e){setTimeout(e,0)},b.contains||(Node.prototype.contains=function(e){return!!(this.compareDocumentPosition(e)&16)}),avalon.contains=function(e,t){try{while(t=t.parentNode)if(t===e)return!0;return!1}catch(n){return!1}};if(r.SVGElement){var A="http://www.w3.org/2000/svg",O=e.createElementNS(A,"svg");O.innerHTML='<circle cx="50" cy="50" r="40" fill="red" />';if(!l.test(O.firstChild)){function M(t,n){if(t&&t.childNodes){var r=t.childNodes;for(var i=0,s;s=r[i++];)if(s.tagName){var o=e.createElementNS(A,s.tagName.toLowerCase());v.forEach.call(s.attributes,function(e){o.setAttribute(e.name,e.value)}),M(s,o),n.appendChild(o)}}}Object.defineProperties(SVGElement.prototype,{outerHTML:{enumerable:!0,configurable:!0,get:function(){return(new XMLSerializer).serializeToString(this)},set:function(t){var n=this.tagName.toLowerCase(),r=this.parentNode,i=avalon.parseHTML(t);if(n==="svg")r.insertBefore(i,this);else{var s=e.createDocumentFragment();M(i,s),r.insertBefore(s,this)}r.removeChild(this)}},innerHTML:{enumerable:!0,configurable:!0,get:function(){var e=this.outerHTML,t=new RegExp("<"+this.nodeName+'\\b(?:(["\'])[^"]*?(\\1)|[^>])*>',"i"),n=new RegExp("</"+this.nodeName+">$","i");return e.replace(t,"").replace(n,"")},set:function(e){if(avalon.clearHTML){avalon.clearHTML(this);var t=avalon.parseHTML(e);M(t,this)}}}})}}var _=avalon.vmodels={};avalon.define=function(e,t){var n=e.$id||e;n||T("warning: 必须指定$id"),_[n]&&T("warning: "+n+" 已经存在于avalon.vmodels中");if(typeof e=="object")var r=H(e);else{var i={$watch:x};t(i),r=H(i),o=!0,t(r),o=!1}return r.$id=n,_[n]=r};var D=String("$id,$watch,$unwatch,$fire,$events,$model,$skipArray").match(u),B=Object.is||function(e,t){return e===0&&t===0?1/e===1/t:e!==e?t!==t:e===t},I={},q=0,R={},X,V,$,J,K,Q=/[-.*+?^${}()|[\]\/\\]/g,Y=x,Z={loader:function(e){r.define=e?Y.define:s,r.require=e?Y:i},interpolate:function(e){X=e[0],V=e[1];if(X===V)avalon.error("openTag!==closeTag",SyntaxError);else if(e+""=="<!--,-->")W.commentInterpolate=!0;else{var t=X+"test"+V;E.innerHTML=t,E.innerHTML!==t&&E.innerHTML.indexOf("&lt;")>=0&&avalon.error("此定界符不合法",SyntaxError),E.innerHTML=""}var n=G(X),r=G(V);$=new RegExp(n+"(.*?)"+r),J=new RegExp(n+"(.*?)"+r,"g"),K=new RegExp(n+".*?"+r+"|\\sms-")}};W.debug=!0,W.plugins=Z,W.plugins.interpolate(["{{","}}"]),W.paths={},W.shim={},W.maxRepeatSize=100,avalon.config=W,"add,remove".replace(u,function(e){avalon.fn[e+"Class"]=function(t){var n=this[0];return t&&typeof t=="string"&&n&&n.nodeType===1&&t.replace(/\S+/g,function(t){n.classList[e](t)}),this}}),avalon.fn.mix({hasClass:function(e){var t=this[0]||{};return t.nodeType===1&&t.classList.contains(e)},toggleClass:function(e,t){var n,r=0,i=e.split(/\s+/),s=typeof t=="boolean";while(n=i[r++]){var o=s?t:!this.hasClass(n);this[o?"addClass":"removeClass"](n)}return this},attr:function(e,t){return arguments.length===2?(this[0].setAttribute(e,t),this):this[0].getAttribute(e)},data:function(e,t){e="data-"+et(e||"");switch(arguments.length){case 2:return this.attr(e,t),this;case 1:var n=this.attr(e);return rt(n);case 0:var r={};return v.forEach.call(this[0].attributes,function(t){t&&(e=t.name,e.indexOf("data-")||(e=tt(e.slice(5)),r[e]=rt(t.value)))}),r}},removeData:function(e){return e="data-"+et(e),this[0].removeAttribute(e),this},css:function(e,t){if(avalon.isPlainObject(e))for(var n in e)avalon.css(this,n,e[n]);else var r=avalon.css(this,e,t);return r!==void 0?r:this},position:function(){var e,t,n=this[0],r={top:0,left:0};if(!n)return;return this.css("position")==="fixed"?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),e[0].tagName!=="HTML"&&(r=e.offset()),r.top+=avalon.css(e[0],"borderTopWidth",!0),r.left+=avalon.css(e[0],"borderLeftWidth",!0)),{top:t.top-r.top-avalon.css(n,"marginTop",!0),left:t.left-r.left-avalon.css(n,"marginLeft",!0)}},offsetParent:function(){var e=this[0].offsetParent||b;while(e&&e.tagName!=="HTML"&&avalon.css(e,"position")==="static")e=e.offsetParent;return avalon(e||b)},bind:function(e,t,n){if(this[0])return avalon.bind(this[0],e,t,n)},unbind:function(e,t,n){return this[0]&&avalon.unbind(this[0],e,t,n),this},val:function(e){var t=this[0];if(t&&t.nodeType===1){var n=arguments.length===0,r=n?":get":":set",i=ht[ct(t)+r];if(i)var s=i(t,e);else{if(n)return(t.value||"").replace(/\r/g,"");t.value=e}}return n?s:this}}),b.dataset&&(avalon.fn.data=function(e,t){var n=this[0].dataset;switch(arguments.length){case 2:return n[e]=t,this;case 1:return t=n[e],rt(t);case 0:var r={};for(var e in n)r[e]=rt(n[e]);return r}});var nt=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/;avalon.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){avalon.fn[e]=function(n){var r=this[0]||{},i=it(r),s=e==="scrollTop";if(!arguments.length)return i?i[t]:r[e];i?i.scrollTo(s?avalon(i).scrollLeft():n,s?n:avalon(i).scrollTop()):r[e]=n}});var st=avalon.cssHooks={},ot=["","-webkit-","-moz-","-ms-"],ut={"float":"cssFloat"};avalon.cssNumber=N("columnCount,order,fillOpacity,fontWeight,lineHeight,opacity,orphans,widows,zIndex,zoom"),avalon.cssName=function(e,t,n){if(ut[e])return ut[e];t=t||b.style;for(var r=0,i=ot.length;r<i;r++){n=tt(ot[r]+e);if(n in t)return ut[e]=n}return null},st["@:set"]=function(e,t,n){e.style[t]=n},st["@:get"]=function(e,t){if(!e||!e.style)throw new Error("getComputedStyle要求传入一个节点 "+e);var n,r=getComputedStyle(e,null);return r&&(n=t==="filter"?r.getPropertyValue(t):r[t],n===""&&(n=e.style[t])),n},st["opacity:get"]=function(e){var t=st["@:get"](e,"opacity");return t===""?"1":t},"top,left".replace(u,function(e){st[e+":get"]=function(t){var n=st["@:get"](t,e);return/px$/.test(n)?n:avalon(t).position()[e]+"px"}});var at={position:"absolute",visibility:"hidden",display:"block"},ft=/^(none|table(?!-c[ea]).+)/;"Width,Height".replace(u,function(e){var t=e.toLowerCase(),n="client"+e,r="scroll"+e,i="offset"+e;st[t+":get"]=function(t,n,r){var s=-4;typeof r=="number"&&(s=r),n=e==="Width"?["Left","Right"]:["Top","Bottom"];var o=t[i];return s===2?o+avalon.css(t,"margin"+n[0],!0)+avalon.css(t,"margin"+n[1],!0):(s<0&&(o=o-avalon.css(t,"border"+n[0]+"Width",!0)-avalon.css(t,"border"+n[1]+"Width",!0)),s===-4&&(o=o-avalon.css(t,"padding"+n[0],!0)-avalon.css(t,"padding"+n[1],!0)),o)},st[t+"&get"]=function(e){var n=[];lt(e,n);var r=st[t+":get"](e);for(var i=0,s;s=n[i++];){e=s.node;for(var o in s)typeof s[o]=="string"&&(e.style[o]=s[o])}return r},avalon.fn[t]=function(s){var o=this[0];if(arguments.length===0){if(o.setTimeout)return o["inner"+e]||o.document.documentElement[n];if(o.nodeType===9){var u=o.documentElement;return Math.max(o.body[r],u[r],o.body[i],u[i],u[n])}return st[t+"&get"](o)}return this.css(t,s)},avalon.fn["inner"+e]=function(){return st[t+":get"](this[0],void 0,-2)},avalon.fn["outer"+e]=function(e){return st[t+":get"](this[0],void 0,e===!0?2:0)}}),avalon.fn.offset=function(){var e=this[0],t={left:0,top:0};if(!e||!e.tagName||!e.ownerDocument)return t;var n=e.ownerDocument,r=n.documentElement,i=n.defaultView;return r.contains(e)?(e.getBoundingClientRect!==void 0&&(t=e.getBoundingClientRect()),{top:t.top+i.pageYOffset-r.clientTop,left:t.left+i.pageXOffset-r.clientLeft}):t};var ht={"select:get":function(e,t){var n,r=e.options,i=e.selectedIndex,s=e.type==="select-one"||i<0,o=s?null:[],u=s?i+1:r.length,a=i<0?u:s?i:0;for(;a<u;a++){n=r[a];if((n.selected||a===i)&&!n.disabled){t=n.value;if(s)return t;o.push(t)}}return o},"select:set":function(e,t,n){t=[].concat(t);for(var r=0,i;i=e.options[r++];)if(i.selected=t.indexOf(i.value)>=0)n=!0;n||(e.selectedIndex=-1)}},pt=new function(){avalon.mix(this,{option:e.createElement("select"),thead:e.createElement("table"),td:e.createElement("tr"),area:e.createElement("map"),tr:e.createElement("tbody"),col:e.createElement("colgroup"),legend:e.createElement("fieldset"),_default:e.createElement("div"),g:e.createElementNS("http://www.w3.org/2000/svg","svg")}),this.optgroup=this.option,this.tbody=this.tfoot=this.colgroup=this.caption=this.thead,this.th=this.td};pt.optgroup=pt.option,pt.tbody=pt.tfoot=pt.colgroup=pt.caption=pt.thead,pt.th=pt.td,String("circle,defs,ellipse,image,line,path,polygon,polyline,rect,symbol,text,use").replace(u,function(e){pt[e]=pt.g});var dt=/<([\w:]+)/,vt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,mt=N(["","text/javascript","text/ecmascript","application/ecmascript","application/javascript"]),gt=e.createElement("script");avalon.parseHTML=function(e){typeof e!="string"&&(e+=""),e=e.replace(vt,"<$1></$2>").trim();var t=(dt.exec(e)||["",""])[1].toLowerCase(),n=pt[t]||pt._default,r=w.cloneNode(!1),i;n.innerHTML=e;var s=n.getElementsByTagName("script");if(s.length)for(var o=0,u;u=s[o++];)if(mt[u.type]){var a=gt.cloneNode(!1);v.forEach.call(u.attributes,function(e){a.setAttribute(e.name,e.value)}),a.text=u.text,u.parentNode.replaceChild(a,u)}while(i=n.firstChild)r.appendChild(i);return r},avalon.innerHTML=function(e,t){var n=this.parseHTML(t);this.clearHTML(e).appendChild(n)},avalon.clearHTML=function(e){e.textContent="";while(e.firstChild)e.removeChild(e.firstChild);return e};var yt={$watch:function(e,t){if(typeof t=="function"){var n=this.$events[e];n?n.push(t):this.$events[e]=[t]}else this.$events=this.$watch.backup;return this},$unwatch:function(e,t){var n=arguments.length;if(n===0)this.$watch.backup=this.$events,this.$events={};else if(n===1)this.$events[e]=[];else{var r=this.$events[e]||[],i=r.length;while(~--i<0)if(r[i]===t)return r.splice(i,1)}return this},$fire:function(t){var n;/^(\w+)!(\S+)$/.test(t)&&(n=RegExp.$1,t=RegExp.$2);var r=this.$events,i=m.call(arguments,1),s=[t].concat(i);if(n==="all")for(var o in avalon.vmodels){var u=avalon.vmodels[o];u!==this&&u.$fire.apply(u,s)}else if(n==="up"||n==="down"){var a=r.expr&&bt(r.expr);if(!a)return;for(var o in avalon.vmodels){var u=avalon.vmodels[o];if(u!==this&&u.$events.expr){var f=bt(u.$events.expr);if(!f)continue;var l=n==="down"?a.contains(f):f.contains(a);l&&(f._avalon=u)}}var c=e.getElementsByTagName("*"),h=[];Array.prototype.forEach.call(c,function(e){e._avalon&&(h.push(e._avalon),e._avalon="",e.removeAttribute("_avalon"))}),n==="up"&&h.reverse();for(var o=0,p;p=h[o++];)if(p.$fire.apply(p,s)===!1)break}else{var d=r[t]||[],v=r.$all||[];for(var o=0,g;g=d[o++];)k(g)&&g.apply(this,i);for(var o=0,g;g=v[o++];)k(g)&&g.apply(this,arguments)}}},wt=/^(duplex|on)$/,Tt=[],Nt=0,Ct=200,kt=Date.now(),Lt,Mt={};avalon.scanCallback=function(e,t){t=t||"$all";var n=Mt[t]||(Mt[t]=[]);n.push(e)},avalon.scan=function(e,t,n){function f(e){s+=e,a=!0,setTimeout(function(){if(s<=0&&!o){o=!0;while(u=r.shift())u()}})}e=e||b,n=n||"$all";var r=Mt[n]||[],i=t?[].concat(t):[],s=0,o=!1,u,a=!1;i.cb=f,Pt(e,i);if(!a)while(u=r.shift())u()};var _t=N("area,base,basefont,br,col,command,embed,hr,img,input,link,meta,param,source,track,wbr,noscript,noscript,script,style,textarea".toUpperCase()),qt=/ms-(\w+)-?(.*)/,Rt={"if":10,repeat:90,data:100,widget:110,each:1400,"with":1500,duplex:2e3,on:3e3},Ut=N("animationend,blur,change,input,click,dblclick,focus,keydown,keypress,keyup,mousedown,mouseenter,mouseleave,mousemove,mouseout,mouseover,mouseup,scan,scroll,submit"),zt=N("value,title,alt,checked,selected,disabled,readonly,enabled"),Vt=/\|\s*(\w+)\s*(\([^)]*\))?/g,$t=/\|\|/g,Jt=/U2hvcnRDaXJjdWl0/g,Gt="break,case,catch,continue,debugger,default,delete,do,else,false,finally,for,function,if,in,instanceof,new,null,return,switch,this,throw,true,try,typeof,var,void,while,with,abstract,boolean,byte,char,class,const,double,enum,export,extends,final,float,goto,implements,import,int,interface,long,native,package,private,protected,public,short,static,super,synchronized,throws,transient,volatile,arguments,let,yield,undefined",Yt=/\/\*[\w\W]*?\*\/|\/\/[^\n]*\n|\/\/[^\n]*$|"(?:[^"\\]|\\[\w\W])*"|'(?:[^'\\]|\\[\w\W])*'|[\s\t\n]*\.[\s\t\n]*[$\w\.]+/g,Zt=/[^\w$]+/g,en=new RegExp(["\\b"+Gt.replace(/,/g,"\\b|\\b")+"\\b"].join("|"),"g"),tn=/\b\d[^,]*/g,nn=/^,+|,+$/g,rn=an(512),sn=function(e){var t=","+e.trim();if(rn[t])return rn[t];var n=e.replace(Yt,"").replace(Zt,",").replace(en,"").replace(tn,"").replace(nn,"").split(/^$|,+/);return rn(t,un(n))},fn=an(128),ln=/\w\[.*\]|\w\.\w/,cn=/(\$proxy\$[a-z]+)\d+$/;avalon.parseExprProxy=pn,y.insertAdjacentHTML("afterBegin",'<avalon><style id="avalonStyle">.avalonHide{ display: none!important }</style></avalon>');var dn=y.firstChild,vn=function(e,t,n){var r=e.getAttribute(t);if(r)for(var i=0,s;s=n[i++];)if(s.hasOwnProperty(r)&&typeof s[r]=="function")return s[r]},mn=avalon.templateCache={},gn="autofocus,autoplay,async,checked,controls,declare,disabled,defer,defaultChecked,defaultSelectedcontentEditable,isMap,loop,multiple,noHref,noResize,noShade,open,readOnly,selected",yn={};gn.replace(u,function(e){yn[e.toLowerCase()]=e});var bn=avalon.bindingExecutors={attr:function(t,n,i){var s=i.type,o=i.param;if(s==="css")avalon(n).css(o,t);else if(s==="attr"){if(yn[o]){var u=yn[o];if(typeof n[u]=="boolean")return n[u]=!!t}var a=t===!1||t===null||t===void 0;if(a)return n.removeAttribute(o);var f=l.test(n)?!1:o in n.cloneNode(!1);f?n[o]=t:n.setAttribute(o,t)}else if(s==="include"&&t){var c=i.vmodels,h=i.includeRendered,p=i.includeLoaded,d=i.includeReplaced,v=d?n.parentNode:n;function m(e){p&&(e=p.apply(v,[e].concat(c))),h&&Dt(v,function(){h.call(v)},NaN);for(;;){var t=i.startInclude.nextSibling;if(!t||t===i.endInclude)break;v.removeChild(t)}var n=avalon.parseHTML(e),r=avalon.slice(n.childNodes);v.insertBefore(n,i.endInclude),jt(r,c),c.cb(-1)}if(i.param==="src")if(mn[t])avalon.nextTick(function(){m(mn[t])});else{var g=new r.XMLHttpRequest;g.onload=function(){var e=g.status;(e>=200&&e<300||e===304)&&m(mn[t]=g.responseText)},g.open("GET",t,!0),g.withCredentials=!0,g.setRequestHeader("X-Requested-With","XMLHttpRequest"),g.send(null)}else{var y=t&&t.nodeType==1?t:e.getElementById(t);avalon.nextTick(function(){m(y.value||y.innerText||y.innerHTML)})}}else{n[s]=t;if(r.chrome&&n.tagName==="EMBED"){var b=n.parentNode,w=document.createComment("ms-src");b.replaceChild(w,n),b.replaceChild(n,w)}}},"class":function(e,t,n){var r=avalon(t),i=n.type;if(i==="class"&&n.oldStyle)r.toggleClass(n.oldStyle,!!e);else{n.toggleClass=n._evaluator?!!n._evaluator.apply(t,n._args):!0,n.newClass=n.immobileClass||e,n.oldClass&&n.newClass!==n.oldClass&&r.removeClass(n.oldClass),n.oldClass=n.newClass;switch(i){case"class":r.toggleClass(n.newClass,n.toggleClass);break;case"hover":case"active":if(!n.hasBindEvent){var s="mouseenter",o="mouseleave";i==="active"&&(t.tabIndex=t.tabIndex||-1,s="mousedown",o="mouseup",r.bind("mouseleave",function(){n.toggleClass&&r.removeClass(n.newClass)})),r.bind(s,function(){n.toggleClass&&r.addClass(n.newClass)}),r.bind(o,function(){n.toggleClass&&r.removeClass(n.newClass)}),n.hasBindEvent=!0}}}},data:function(e,t,n){var r="data-"+n.param;e&&typeof e=="object"?t[r]=e:t.setAttribute(r,String(e))},repeat:function(e,t,n){if(e){var r=this,i=r.element.parentNode,s=r.proxies,o=w.cloneNode(!1);if(e==="del"||e==="move")var u=Un(r,t);var a=r.group;switch(e){case"add":var f=n,l=r.$repeat.length-1,c=[];for(var h=0,p=f.length;h<p;h++){var d=h+t,v=Jn(d,f[h],r,l);s.splice(d,0,v),Rn(r,o,v,c)}u=Un(r,t),i.insertBefore(o,u);for(var h=0,m;m=c[h++];)jt(m.nodes,m.vmodels),m.nodes=m.vmodels=null;Wn(r);break;case"del":var g=s.splice(t,n),o=zn(u,a,n);avalon.clearHTML(o),Kn(g);break;case"index":var l=s.length-1;for(;n=s[t];t++)n.$index=t,n.$first=t===0,n.$last=t===l;break;case"clear":for(;;){var y=r.element.nextSibling;if(!y||y===r.endRepeat)break;i.removeChild(y)}break;case"move":var b=s.splice(t,1)[0];b&&(s.splice(n,0,b),o=zn(u,a),u=Un(r,n),i.insertBefore(o,u));break;case"set":var v=s[t];v&&(v[v.$itemName]=n);break;case"append":var E=n,S=[],c=[];for(var T in t)t.hasOwnProperty(T)&&T!=="hasOwnProperty"&&S.push(T);if(r.sortedCallback){var N=r.sortedCallback.call(i,S);N&&Array.isArray(N)&&N.length&&(S=N)}for(var h=0,T;T=S[h++];)T!=="hasOwnProperty"&&Rn(r,o,E[T],c);r.proxySize=S.length,i.insertBefore(o,r.element.nextSibling);for(var h=0,m;m=c[h++];)jt(m.nodes,m.vmodels),m.nodes=m.vmodels=null;Wn(r)}var C=r.renderedCallback||x,k=arguments;Dt(i,function(){C.apply(i,k),i.oldValue&&i.tagName==="SELECT"&&e==="index"&&avalon(i).val(i.oldValue.split(","))},NaN)}},html:function(t,n,r){t=t==null?"":t;var i="group"in r?n.parentNode:n;if("group"in r){var s,o;if(t.nodeType===11)s=t;else if(t.nodeType===1||t.item){o=t.nodeType===1?t.childNodes:t.item?t:[],s=w.cloneNode(!0);while(o[0])s.appendChild(o[0])}else s=avalon.parseHTML(t);o=avalon.slice(s.childNodes);if(o.length==0){var u=e.createComment("ms-html");s.appendChild(u),o=[u]}i.insertBefore(s,n);var a=r.group;while(n){var f=n.nextSibling;i.removeChild(n),a--;if(a==0||f===null)break;n=f}r.element=o[0],r.group=o.length}else avalon.innerHTML(i,t);r.vmodels.cb(1),avalon.nextTick(function(){Bt(i,r.vmodels),r.vmodels.cb(-1)})},"if":function(t,n,r){if(t)n.nodeType===8&&(n.parentNode.replaceChild(r.template,n),n=r.element=r.template),n.getAttribute(r.name)&&(n.removeAttribute(r.name),Wt(n,r.vmodels));else if(n.nodeType===1){var i=r.element=e.createComment("ms-if");n.parentNode.replaceChild(i,n),r.template=n,dn.appendChild(n)}},on:function(e,t,n){n.type="on",e=function(e){var t=n.evaluator||x;return t.apply(this,n.args.concat(e))};var r=n.param.replace(/-\d+$/,"");if(r==="scan")e.call(t,{type:r});else if(typeof n.specialBind=="function")n.specialBind(t,e);else var i=avalon.bind(t,r,e);n.rollback=function(){typeof n.specialUnbind=="function"?n.specialUnbind():avalon.unbind(t,n.param,i)}},text:function(e,t){e=e==null?"":e;if(t.nodeType===3)try{t.data=e}catch(n){}else t.textContent=e},visible:function(e,t,n){t.style.display=e?n.display:"none"},widget:x},wn=/\(([^)]*)\)/;avalon.parseDisplay=En;var Sn=avalon.bindingHandlers={attr:function(t,n){var r=t.value.trim(),i=!0;r.indexOf(X)>-1&&r.indexOf(V)>2&&(i=!1,$.test(r)&&RegExp.rightContext===""&&RegExp.leftContext===""&&(i=!0,r=RegExp.$1));if(t.type==="include"){var s=t.element;t.includeRendered=vn(s,"data-include-rendered",n),t.includeLoaded=vn(s,"data-include-loaded",n);var o=t.includeReplaced=!!avalon(s).data("includeReplace");t.startInclude=e.createComment("ms-include"),t.endInclude=e.createComment("ms-include-end"),o?(t.element=t.startInclude,s.parentNode.insertBefore(t.startInclude,s),s.parentNode.insertBefore(t.endInclude,s.nextSibling)):(s.insertBefore(t.startInclude,s.firstChild),s.appendChild(t.endInclude))}t.handlerName="attr",pn(r,n,t,i?null:Qt(t.value))},"class":function(e,t){var n=e.param,r=e.value,i;e.handlerName="class";if(!n||isFinite(n)){e.param="";var s=r.replace(J,function(e){return Math.pow(10,e.length-1)}),o=s.indexOf(":");if(o===-1)var u=r;else{u=r.slice(0,o),i=r.slice(o+1),hn(i,t,e);if(!e.evaluator)return T("debug: ms-class '"+(i||"").trim()+"' 不存在于VM中"),!1;e._evaluator=e.evaluator,e._args=e.args}var a=$.test(u);a||(e.immobileClass=u),pn("",t,e,a?Qt(u):null)}else e.immobileClass=e.oldStyle=e.param,pn(r,t,e)},duplex:function(e,t){var n=e.element,r;pn(e.value,t,e,0,1),e.changed=vn(n,"data-duplex-changed",t)||x;if(e.evaluator&&e.args){var i=[],s=N("string,number,boolean,checked");n.type==="radio"&&e.param===""&&(e.param="checked"),e.param.replace(/\w+/g,function(t){/^(checkbox|radio)$/.test(n.type)&&/^(radio|checked)$/.test(t)&&(T("ms-duplex-radio已经更名为ms-duplex-checked"),t="checked",e.isChecked=!0),t==="bool"?(t="boolean",T("ms-duplex-bool已经更名为ms-duplex-boolean")):t==="text"&&(t="string",T("ms-duplex-text已经更名为ms-duplex-string")),s[t]&&(r=!0),avalon.Array.ensure(i,t)}),r||i.push("string"),e.param=i.join("-"),e.bound=function(t,r){n.addEventListener(t,r);var i=e.rollback;e.rollback=function(){n.removeEventListener(t,r),i&&i()}};for(var o in avalon.vmodels){var u=avalon.vmodels[o];u.$fire("avalon-ms-duplex-init",e)}var a=e.pipe||(e.pipe=Nn);a(null,e,"init");var f=n.tagName;xn[f]&&xn[f](n,e.evaluator.apply(null,e.args),e)}},repeat:function(t,r){var i=t.type;pn(t.value,r,t,0,1),t.proxies=[];var s=!1;try{var o=t.$repeat=t.evaluator.apply(0,t.args||[]),u=avalon.type(o);u!=="object"&&u!=="array"&&(s=!0,avalon.log("warning:"+t.value+"对应类型不正确"))}catch(a){s=!0,avalon.log("warning:"+t.value+"编译出错")}var f=t.element;f.removeAttribute(t.name),t.sortedCallback=vn(f,"data-with-sorted",r),t.renderedCallback=vn(f,"data-"+i+"-rendered",r);var l=t.element=e.createComment("ms-repeat"),c=t.endRepeat=e.createComment("ms-repeat-end");w.appendChild(l),w.appendChild(c),i==="each"||i==="with"?(t.template=f.innerHTML.trim(),avalon.clearHTML(f).appendChild(w)):(t.template=f.outerHTML.trim(),f.parentNode.replaceChild(w,f),t.group=1),t.rollback=function(){bn.repeat.call(t,"clear");var e=t.element,n=e.parentNode,r=avalon.parseHTML(t.template),i=r.firstChild;n.replaceChild(r,e),n.removeChild(t.endRepeat),i=t.element=t.type==="repeat"?i:n,t.group=i.setAttribute(t.name,t.value)};var h=t.value.split(".")||[];if(h.length>1){h.pop();var p=h[0];for(var d=0,v;v=r[d++];)if(v&&v.hasOwnProperty(p)){var m=v[p].$events;m[n]=m[n]||[],m[n].push(t);break}}if(s)return;t.handler=bn.repeat,t.$outer={};var g="$key",y="$val";Array.isArray(o)&&(g="$first",y="$last");for(var d=0,b;b=r[d++];)if(b.hasOwnProperty(g)&&b.hasOwnProperty(y)){t.$outer=b;break}var E=(o.$events||{})[n];E&&avalon.Array.ensure(E,t)&&xt(t,E);if(!Array.isArray(o)&&i!=="each"){var S=I[o.$id];if(!S){q++,S=I[o.$id]={};for(var x in o)o.hasOwnProperty(x)&&x!=="hasOwnProperty"&&function(e,t){S[e]=Vn(e,t,{}),S[e].$watch("$val",function(t){o[e]=t})}(x,o[x])}t.handler("append",o,S)}else t.handler("add",0,o)},html:function(e,t){pn(e.value,t,e)},on:function(e,t){var n=e.value,r=e.param.replace(/-\d+$/,"");typeof Sn.on[r+"Hook"]=="function"&&Sn.on[r+"Hook"](e);if(n.indexOf("(")>0&&n.indexOf(")")>-1){var i=(n.match(wn)||["",""])[1].trim();if(i===""||i==="$event")n=n.replace(wn,"")}pn(n,t,e)},visible:function(e,t){var n=avalon(e.element),r=n.css("display");if(r==="none"){var i=n[0].style,s=/visibility/i.test(i.cssText),o=n.css("visibility");i.display="",i.visibility="hidden",r=n.css("display"),r==="none"&&(r=En(n[0].nodeName)),i.visibility=s?o:""}e.display=r,pn(e.value,t,e)},widget:function(e,t){var n=e.value.match(u),i=e.element,s=n[0],o=n[1];if(!o||o==="$")o=s+setTimeout("1");var a=n[2]||s;t.cb(-1);var f=avalon.ui[s];if(typeof f=="function"){t=i.vmodels||t;for(var l=0,c;c=t[l++];)if(c.hasOwnProperty(a)&&typeof c[a]=="object"){var h=c[a];h=h.$model||h;break}if(h){var p=h[s+"Id"];typeof p=="string"&&(o=p)}var d=avalon.getWidgetData(i,s);e.value=[s,o,a].join(","),e[s+"Id"]=o,i.msData["ms-widget-id"]=o,e.evaluator=x;var v=e[s+"Options"]=avalon.mix({},f.defaults,h||{},d);i.removeAttribute("ms-widget");var m=f(i,e,t)||{};if(m.$id){avalon.vmodels[o]=m,Ht(i,m),m.hasOwnProperty("$init")&&m.$init(function(){var e=[m].concat(t);e.cb=t.cb,avalon.scan(i,e),typeof v.onInit=="function"&&v.onInit.call(i,m,v,t)});if(m.hasOwnProperty("$remove")){function g(){if(!i.msRetain&&!b.contains(i))return m.$remove(),i.msData={},delete _[m.$id],!1}r.chrome?i.addEventListener("DOMNodeRemovedFromDocument",function(){setTimeout(g)}):avalon.tick(g)}}else avalon.scan(i,t)}else t.length&&(i.vmodels=t)}};"hover,active".replace(u,function(e){Sn[e]=Sn["class"]}),"with,each".replace(u,function(e){Sn[e]=Sn.repeat}),Sn["if"]=Sn.data=Sn.text=Sn.html,"title,alt,src,value,css,include,href".replace(u,function(e){Sn[e]=Sn.attr});var xn=Sn.duplex;avalon.duplexHooks={checked:{get:function(e,t){return!t.element.oldValue}},string:{get:function(e){return e},set:Tn},"boolean":{get:function(e){return e==="true"},set:Tn},number:{get:function(e,t){return isFinite(e)?parseFloat(e)||0:e},set:Tn}},xn.INPUT=function(e,t,n){function a(e){n.changed.call(this,e,n)}function f(){o=!0}function l(){o=!1}function c(){if(o)return;var r=e.oldValue=e.value,i=n.pipe(r,n,"get");s.data("duplex-observe")!==!1&&(t(i),a.call(e,i),s.data("duplex-focus")&&avalon.nextTick(function(){e.focus()}))}var r=e.type,i=n.bound,s=avalon(e),o=!1;n.handler=function(){var r=n.pipe(t(),n,"set");r!==e.value&&(e.value=r)};if(n.isChecked||e.type==="radio")c=function(){if(s.data("duplex-observe")!==!1){var r=n.pipe(e.value,n,"get");t(r),a.call(e,r)}},n.handler=function(){var r=t(),i=n.isChecked?!!r:r+""===e.value;e.checked=e.oldValue=i},i("click",c);else if(r==="checkbox")c=function(){if(s.data("duplex-observe")!==!1){var r=e.checked?"ensure":"remove",i=t();Array.isArray(i)||(T("ms-duplex应用于checkbox上要对应一个数组"),i=[i]),avalon.Array[r](i,n.pipe(e.value,n,"get")),a.call(e,i)}},n.handler=function(){var r=[].concat(t());e.checked=r.indexOf(n.pipe(e.value,n,"get"))>=0},i("change",c);else{var h=e.getAttribute("data-duplex-event")||e.getAttribute("data-event")||"input";e.attributes["data-event"]&&T("data-event指令已经废弃，请改用data-duplex-event"),h.replace(u,function(e){switch(e){case"input":i("input",c),i("compositionstart",f),i("compositionend",l);break;default:i(e,c)}})}e.oldValue=e.value,Ln(function(){if(avalon.contains(b,e))On.call(e);else if(!e.msRetain)return!1}),Et(n),a.call(e,e.value)};var Cn,kn=[],Ln=x;avalon.tick=function(e){kn.push(e)===1&&(Cn=setInterval(Mn,60))};try{var Dn=HTMLInputElement.prototype,Pn=Object.getOwnPropertyDescriptor(Dn,"value").set;Object.defineProperty(Dn,"value",{set:_n,configurable:!0})}catch(Hn){Ln=avalon.tick}xn.SELECT=function(e,t,n){function i(){if(r.data("duplex-observe")!==!1){var i=r.val();Array.isArray(i)?i=i.map(function(e){return n.pipe(e,n,"get")}):i=n.pipe(i,n,"get"),i+""!==e.oldValue&&t(i),n.changed.call(e,i,n)}}var r=avalon(e);n.handler=function(){var n=t();n=n&&n.$model||n,Array.isArray(n)?e.multiple||T("ms-duplex在<select multiple=true>上要求对应一个数组"):e.multiple&&T("ms-duplex在<select multiple=false>不能对应一个数组"),n=Array.isArray(n)?n.map(String):n+"",n+""!==e.oldValue&&(r.val(n),e.oldValue=n+"")},n.bound("change",i),Dt(e,function(){Et(n),n.changed.call(e,t(),n)},NaN)},xn.TEXTAREA=xn.INPUT;var Bn=avalon.eventHooks;"onmouseenter"in b||avalon.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){Bn[e]={type:t,deel:function(t,n){return function(r){var i=r.relatedTarget;if(!i||i!==t&&!(t.compareDocumentPosition(i)&16))return delete r.type,r.type=e,n.call(t,r)}}}}),avalon.each({AnimationEvent:"animationend",WebKitAnimationEvent:"webkitAnimationEnd"},function(e,t){r[e]&&!Bn.animationend&&(Bn.animationend={type:t})}),e.onmousewheel===void 0&&(Bn.mousewheel={type:"wheel",deel:function(e,t){return function(n){n.wheelDeltaY=n.wheelDelta=n.deltaY>0?-120:120,n.wheelDeltaX=0,Object.defineProperty(n,"type",{value:"mousewheel"}),t.call(e,n)}}});var Fn=v.splice,In={_splice:Fn,_fire:function(e,t,r){Ot(this.$events[n],e,t,r)},_add:function(e,t){var n=this.length;t=typeof t=="number"?t:n;var r=[];for(var i=0,s=e.length;i<s;i++)r[i]=qn(e[i],this.$model[t+i]);Fn.apply(this,[t,0].concat(r)),this._fire("add",t,r);if(!this._stopFireLength)return this._.length=this.length},_del:function(e,t){var n=this._splice(e,t);return n.length&&(this._fire("del",e,t),this._stopFireLength||(this._.length=this.length)),n},push:function(){v.push.apply(this.$model,arguments);var e=this._add(arguments);return this._fire("index",e>2?e-2:0),e},pushArray:function(e){return this.push.apply(this,e)},unshift:function(){v.unshift.apply(this.$model,arguments);var e=this._add(arguments,0);return this._fire("index",arguments.length),e},shift:function(){var e=this.$model.shift();return this._del(0,1),this._fire("index",0),e},pop:function(){var e=this.$model.pop();return this._del(this.length-1,1),e},splice:function(e,t){var n=this.length;e=Math.floor(e)||0,e=e<0?Math.max(n+e,0):Math.min(e,n);var r=Fn.apply(this.$model,arguments),i=[],s;return this._stopFireLength=!0,r.length&&(i=this._del(e,r.length),s=!0),arguments.length>2&&(this._add(m.call(arguments,2),e),s=!0),this._stopFireLength=!1,this._.length=this.length,s&&this._fire("index",0),i},contains:function(e){return this.indexOf(e)!==-1},size:function(){return this._.length},remove:function(e){return this.removeAt(this.indexOf(e))},removeAt:function(e){return e>=0?this.splice(e,1):[]},clear:function(){return this.$model.length=this.length=this._.length=0,this._fire("clear",0),this},removeAll:function(e){if(Array.isArray(e))e.forEach(function(e){this.remove(e)},this);else if(typeof e=="function")for(var t=this.length-1;t>=0;t--){var n=this[t];e(n,t)&&this.splice(t,1)}else this.clear()},ensure:function(e){return this.contains(e)||this.push(e),this},set:function(e,t){if(e>=0){var n=avalon.type(t);t&&t.$model&&(t=t.$model);var r=this[e];if(n==="object")for(var i in t)r.hasOwnProperty(i)&&(r[i]=t[i]);else n==="array"?r.clear().push.apply(r,t):r!==t&&(this[e]=t,this.$model[e]=t,this._fire("set",e,t))}return this}};"sort,reverse".replace(u,function(e){In[e]=function(){var t=this.$model,n=t.slice(0),r=!1;v[e].apply(t,arguments);for(var i=0,s=n.length;i<s;i++){var o=t[i],u=n[i];if(!B(o,u)){r=!0;var a=n.indexOf(o,i),f=this._splice(a,1)[0],l=n.splice(a,1)[0];this._splice(i,0,f),n.splice(i,0,l),this._fire("move",a,i)}}return n=void 0,r&&this._fire("index",0),this}});var Xn=N("$index,$first,$last"),$n=[],Gn=/<script[^>]*>([\S\s]*?)<\/script\s*>/gim,Yn=/\s+(on[^=\s]+)(?:=("[^"]*"|'[^']*'|[^\s>]+))?/g,Zn=/<\w+\b(?:(["'])[^"]*?(\1)|[^>])*>/ig,er={a:/\b(href)\=("javascript[^"]*"|'javascript[^']*')/ig,img:/\b(src)\=("javascript[^"]*"|'javascript[^']*')/ig,form:/\b(action)\=("javascript[^"]*"|'javascript[^']*')/ig},tr=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,nr=/([^\#-~| |!])/g,rr=avalon.filters={uppercase:function(e){return e.toUpperCase()},lowercase:function(e){return e.toLowerCase()},truncate:function(e,t,n){return t=t||30,n=n===void 0?"...":n,e.length>t?e.slice(0,t-n.length)+n:String(e)},sanitize:r.toStaticHTML?toStaticHTML.bind(r):function(e){return e.replace(Gn,"").replace(Zn,function(e,t){var n=e.toLowerCase().match(/<(\w+)\s/);if(n){var r=er[n[1]];r&&(e=e.replace(r,function(e,t,n){var r=n.charAt(0);return t+"="+r+"javascript:void(0)"+r}))}return e.replace(Yn," ").replace(/\s+/g," ")})},camelize:tt,escape:function(e){return String(e).replace(/&/g,"&amp;").replace(tr,function(e){var t=e.charCodeAt(0),n=e.charCodeAt(1);return"&#"+((t-55296)*1024+(n-56320)+65536)+";"}).replace(nr,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")},currency:function(e,t){return t=t||"￥",t+avalon.filters.number(e)},number:function(e,t,n,r){e=(e+"").replace(/[^0-9+\-Ee.]/g,"");var i=isFinite(+e)?+e:0,s=isFinite(+t)?Math.abs(t):0,o=r||",",u=n||".",a="",f=function(e,t){var n=Math.pow(10,t);return""+Math.round(e*n)/n};return a=(s?f(i,s):""+Math.round(i)).split("."),a[0].length>3&&(a[0]=a[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,o)),(a[1]||"").length<s&&(a[1]=a[1]||"",a[1]+=(new Array(s-a[1].length+1)).join("0")),a.join(u)}};new function(){function e(e){return parseInt(e,10)}function t(e,t,n){var r="";e<0&&(r="-",e=-e),e=""+e;while(e.length<t)e="0"+e;return n&&(e=e.substr(e.length-t)),r+e}function n(e,n,r,i){return function(s){var o=s["get"+e]();if(r>0||o>-r)o+=r;return o===0&&r===-12&&(o=12),t(o,n,i)}}function r(e,t){return function(n,r){var i=n["get"+e](),s=(t?"SHORT"+e:e).toUpperCase();return r[s][i]}}function i(e){var n=-1*e.getTimezoneOffset(),r=n>=0?"+":"";return r+=t(Math[n>0?"floor":"ceil"](n/60),2)+t(Math.abs(n%60),2),r}function s(e,t){return e.getHours()<12?t.AMPMS[0]:t.AMPMS[1]}function l(t){var n;if(n=t.match(f)){var r=new Date(0),i=0,s=0,o=n[8]?r.setUTCFullYear:r.setFullYear,u=n[8]?r.setUTCHours:r.setHours;n[9]&&(i=e(n[9]+n[10]),s=e(n[9]+n[11])),o.call(r,e(n[1]),e(n[2])-1,e(n[3]));var a=e(n[4]||0)-i,l=e(n[5]||0)-s,c=e(n[6]||0),h=Math.round(parseFloat("0."+(n[7]||0))*1e3);return u.call(r,a,l,c,h),r}return t}var o={yyyy:n("FullYear",4),yy:n("FullYear",2,0,!0),y:n("FullYear",1),MMMM:r("Month"),MMM:r("Month",!0),MM:n("Month",2,1),M:n("Month",1,1),dd:n("Date",2),d:n("Date",1),HH:n("Hours",2),H:n("Hours",1),hh:n("Hours",2,-12),h:n("Hours",1,-12),mm:n("Minutes",2),m:n("Minutes",1),ss:n("Seconds",2),s:n("Seconds",1),sss:n("Milliseconds",3),EEEE:r("Day"),EEE:r("Day",!0),a:s,Z:i},u=/((?:[^yMdHhmsaZE']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|d+|H+|h+|m+|s+|a|Z))(.*)/,a=/^\d+$/,f=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,c=/^(\d+)\D(\d+)\D(\d+)/;rr.date=function(t,n){var r=rr.date.locate,i="",s=[],f,h;n=n||"mediumDate",n=r[n]||n;if(typeof t=="string"){if(a.test(t))t=e(t);else{var p=t.trim();t=p.replace(c,function(e,t,n,r){var i=r.length===4?[r,t,n]:[t,n,r];return i.join("/")}),t=l(t)}t=new Date(t)}typeof t=="number"&&(t=new Date(t));if(avalon.type(t)!=="date")return;while(n)h=u.exec(n),h?(s=s.concat(h.slice(1)),n=s.pop()):(s.push(n),n=null);return s.forEach(function(e){f=o[e],i+=f?f(t,r):e.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),i};var h={AMPMS:{0:"上午",1:"下午"},DAY:{0:"星期日",1:"星期一",2:"星期二",3:"星期三",4:"星期四",5:"星期五",6:"星期六"},MONTH:{0:"1月",1:"2月",2:"3月",3:"4月",4:"5月",5:"6月",6:"7月",7:"8月",8:"9月",9:"10月",10:"11月",11:"12月"},SHORTDAY:{0:"周日",1:"周一",2:"周二",3:"周三",4:"周四",5:"周五",6:"周六"},fullDate:"y年M月d日EEEE",longDate:"y年M月d日",medium:"yyyy-M-d ah:mm:ss",mediumDate:"yyyy-M-d",mediumTime:"ah:mm:ss","short":"yy-M-d ah:mm",shortDate:"yy-M-d",shortTime:"ah:mm"};h.SHORTMONTH=h.MONTH,rr.date.locate=h};var ir=avalon.modules={"ready!":{exports:avalon},avalon:{exports:avalon,state:2}};new function(){function o(e){return(e||"").replace(/[?#].*/,"")}function c(t){var r;try{a.b.c()}catch(i){r=i.stack}if(r)return r=r.split(/[@ ]/g).pop(),r=r[0]==="("?r.slice(1,-1):r.replace(/\s/,""),r.replace(/(:\d+)?:\d+$/i,"");var s=(t?e:y).getElementsByTagName("script");for(var o=s.length,u;u=s[--o];)if((t||u.className===n)&&u.readyState==="interactive")return u.className=u.src}function h(e,t){for(var n in e)if(e[n]==="司徒正美"&&ir[n].state!==2&&(n===t||h(ir[n].deps,t)))return!0}function d(){e:for(var e=t.length,n;n=t[--e];){var r=ir[n],i=r.deps;for(var s in i)if(p.call(i,s)&&ir[s].state!==2)continue e;r.state!==2&&(t.splice(e,1),w(r.id,r.args,r.factory),d())}}function v(e,t){var n=o(e.src);e.onload=e.onerror=null;if(!t)return!0;setTimeout(function(){y.removeChild(e)}),T("debug: 加载 "+n+" 失败"+t+" "+!ir[n].state)}function g(e,t,n,r){if(e==="ready!"||ir[e]&&ir[e].state===2)return e;var i;e=e.replace(/^\w+!/,function(e){return i=e.slice(0,-1),""}),i=i||"js",i=Z[i]||x,typeof W.shim[e]=="object"&&(r=W.shim[e]),W.paths[e]&&(e=W.paths[e]);if(/^(\w+)(\d)?:.*/.test(e))n=e;else{t=t.substr(0,t.lastIndexOf("/"));var u=e.charAt(0);if(u!=="."&&u!=="/")n=s+e;else if(e.slice(0,2)==="./")n=t+e.slice(1);else if(e.slice(0,2)===".."){n=t+"/"+e;while(m.test(n))n=n.replace(m,"")}else u==="/"?n=t+e:avalon.error("不符合模块标识规则: "+e)}e=o(n);var a=i.ext;return a&&e.slice(0-a.length)!==a&&(n+=a),W.nocache&&(n+=(n.indexOf("?")===-1?"?":"&")+Date.now()),i(n,r)}function b(t,r,s){var o=e.createElement("script");o.className=n,o.onload=function(){var e=i.pop();e&&e.delay(r),s&&s(),T("debug: 已成功加载 "+t)},o.onerror=function(){v(o,!0)},o.src=t,y.appendChild(o),T("debug: 正准备加载 "+t)}function w(e,t,n){for(var i=0,s=[],o;o=t[i++];)s.push(ir[o].exports);var u=Object(ir[e]),a=n.apply(r,s);return u.state=2,a!==void 0&&(ir[e].exports=a),a}var t=[],i=[],s;Z.js=function(e,t){var n=o(e);return ir[n]||(ir[n]={id:n,exports:{}},t?Y(t.deps||"",function(){b(e,n,function(){ir[n].state=2,t.exports&&(ir[n].exports=typeof t.exports=="function"?t.exports():r[t.exports]),Y.checkDeps()})}):b(e,n)),n},Z.css=function(t){var n=t.replace(/(#.+|\W)/g,"");if(!e.getElementById(n)){var r=e.createElement("link");r.rel="stylesheet",r.href=t,r.id=n,y.insertBefore(r,y.firstChild)}},Z.css.ext=".css",Z.js.ext=".js",Z.text=function(e){var t=new XMLHttpRequest,n=e.replace(/[?#].*/,"");return ir[n]={},t.onload=function(){ir[n].state=2,ir[n].exports=t.responseText,Y.checkDeps()},t.onerror=function(){avalon.error(e+" 对应资源不存在或没有开启 CORS")},t.open("GET",e,!0),t.withCredentials=!0,t.setRequestHeader("X-Requested-With","XMLHttpRequest"),t.send(),n},"import"in e.createElement("link")&&(Z.text=function(t){function i(e,n){!n&&avalon.error(t+"对应资源不存在或没有开启 CORS"),setTimeout(function(){y.removeChild(r)})}var n=t.replace(/[?#].*/,"");ir[n]={};var r=e.createElement("link");return r.rel="import",r.href=t,r.onload=function(){ir[n].state=2;var e=this["import"];e&&(ir[n].exports=e.documentElement.outerHTML,avalon.require.checkDeps()),i(0,e)},r.onerror=i,y.appendChild(r),n});var f=c(!0);f||(f=avalon.slice(document.scripts).pop().src);var l=o(f);s=W.base=l.slice(0,l.lastIndexOf("/")+1);var m=/\/\w+\/\.\./;Y=avalon.require=function(e,n,r){var i={},o=[],a=0,f=0,l=r||"callback"+setTimeout("1");r=r||s,String(e).replace(u,function(e){var t=g(e,r);t&&(a++,ir[t]&&ir[t].state===2&&f++,i[t]||(o.push(t),i[t]="司徒正美"))}),ir[l]={id:l,factory:n,deps:i,args:o,state:1},a===f?w(l,o,n):t.unshift(l),d()},Y.define=function(e,t,n){var r=avalon.slice(arguments);if(typeof e=="string")var s=r.shift();typeof r[0]=="function"&&r.unshift([]);var u=ir[s]&&ir[s].state>=1?s:o(c());!ir[u]&&s&&(ir[u]={id:u,factory:n,state:1}),n=r[1],n.id=s,n.delay=function(e){r.push(e);var t=!0;try{t=h(ir[e].deps,e)}catch(i){}t&&avalon.error(e+"模块与之前的模块存在循环依赖，请不要直接用script标签引入"+e+"模块"),delete n.delay,Y.apply(null,r)},u?n.delay(u,r):i.push(n)},Y.define.amd=ir,Y.config=W,Y.checkDeps=d};var sr=[];e.readyState==="complete"?setTimeout(or):(e.addEventListener("DOMContentLoaded",or),r.addEventListener("load",or)),avalon.ready=function(e){Y?Y("ready!",e):or===x?e(avalon):sr.push(e)},avalon.config({loader:!0});var ur="[ms-controller],[ms-important]";avalon.ready(function(){var t=e.querySelectorAll(ur),n=[];for(var r=0,i;i=t[r++];)if(!i.__root__){var s=i.querySelectorAll(ur);for(var o=0,u;u=s[o++];)u.__root__=!0;n.push(i)}for(var r=0,i;i=n[r++];)avalon.scan(i)})})(document);